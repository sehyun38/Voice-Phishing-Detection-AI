# Voice-Phishing-Detection-AI

이 프로젝트는 음성 피싱 탐지 AI 모델을 학습하고 테스트하는 시스템입니다. 이 시스템은 여러 종류의 모델을 사용하여 음성 피싱을 탐지하는 데 사용됩니다. 주요 구성 요소는 다음과 같습니다:

## 1. `config` : 파일 경로, 변수 처리
- **최대 토큰 수**는 `config`에서 설정합니다.
- **INPUT_FILE_PATH**와 **FILE_PATH**는 원본 데이터와 전처리 후 데이터를 가리키는 경로를 설정합니다.

## 2. `preprocess` : 데이터 전처리
- 최소 단어 필터링 및 최소 토큰 설정을 정의합니다.
  - **최소 단어**는 필터링 없이 제거하는 단어의 기준을 설정합니다.
  - **최소 토큰**은 중요한 단어가 포함되어 있는 경우 필터링을 제외하는 기준을 설정합니다.

## 3. `token_weight` : 가중치 계산
- 모델 학습 전에 **가중치를 계산하여 파일로 저장**합니다.
  - **파일 경로**는 `config`에서 확인하고 수정 가능합니다.

## 4. 모델 학습
각 모델 파일에서 학습을 진행합니다. 하이퍼파라미터 조정이 가능하며, 조기 종료(ROCAUC, val_loss)도 설정할 수 있습니다. 모델 구조를 저장하는 방식은 두 가지로 나뉩니다:

## 5. 모델 테스트
- **RealTimeDetection_kluebert_v2.py**에서 각 모델을 테스트할 수 있습니다.
- 모든 모델을 학습할 필요는 없습니다. 이미 학습된 모델을 사용할 수 있습니다.

## 6. 앙상블 모델 (미 구현)
앙상블 모델은 `soft_voting`과 `stacking` 두 가지 방법으로 구현됩니다.

- **Soft Voting**: 여러 모델의 예측값 평균을 계산하는 방식입니다.
  - `ensemble_soft_voting`을 통해 실행하며, `soft_voting_tkinter`에서 실행되지 않습니다.
  
- **Stacking**: 여러 모델을 학습시킨 후, 각 모델의 예측값을 다른 방식으로 처리하여 최종 예측값을 도출합니다.
  - `ensemble_stacking`을 통해 학습 후, `stacking_thinter`에서 실행됩니다.
  
앙상블 모델에는 **RCNN**, **TextCNN**, **BiLSTM**, **KLUE BERT Transformer** 모델을 사용할 수 있습니다.

- **최소 학습 모델**: **RCNN**, **TextCNN**, **BiLSTM**은 최소 학습 모델로 필요합니다.
- **KLUE BERT Transformer**: 이 모델을 앙상블에 포함할지 여부는 설정 가능한 변수로 정의됩니다.

## 7. 모델 저장 파일 유형
**.pt 파일**: 모델의 가중치만 저장하며, 별도의 모델 정의가 필요합니다.
- **.pt 파일**: 모델의 가중치와 구조를 모두 저장하여, 별도의 모델 정의 없이 호출할 수 있습니다.

## 8. 모델 구현 방식
- **.pt 파일**
    - `torch load`로 저장하고 있습니다.
- **.pt 파일**
    - **KLUE BERT Transformer**는 `torch trace`를 사용하여 배치 사이즈 1로 더미 데이터를 주고 저장합니다.
    - 그 외 모델은 **torch script**로 구현됩니다.
